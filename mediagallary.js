const projects = [
    {
      title: ' Seed Capital Financial Assistance Scheme', district: 'Ernakulam', department: 'Industrial Development', status: 'running',
      thumbnail: 'https://scontent.fdel29-1.fna.fbcdn.net/v/t39.30808-6/488397894_1121558393315733_4504551950325409630_n.jpg?_nc_cat=102&ccb=1-7&_nc_sid=127cfc&_nc_ohc=JXgSe4bJ8TEQ7kNvwHgg_oB&_nc_oc=AdntoJ6AB-wFSuckmHeYYGUHmOPgVBgx5AFJ0XOjYlfH-K6fVAfdajmGAuA4G14vMgs&_nc_zt=23&_nc_ht=scontent.fdel29-1.fna&_nc_gid=Ge4w_8Bk6G-jziiHj6v6Zg&oh=00_AfO8zpW3lsJnHy-F85O8JcZStTRF8vYvMHS0uYVDlP_utg&oe=685581D0',
      summary: 'The picture appears to show a formal function in Kerala where the Managing Director of KSIDC (Kerala State Industrial Development Corporation), M. G. Rajamanickam, IAS, is involved',
      images: [
        'https://scontent.fdel29-1.fna.fbcdn.net/v/t39.30808-6/488397894_1121558393315733_4504551950325409630_n.jpg?_nc_cat=102&ccb=1-7&_nc_sid=127cfc&_nc_ohc=JXgSe4bJ8TEQ7kNvwHgg_oB&_nc_oc=AdntoJ6AB-wFSuckmHeYYGUHmOPgVBgx5AFJ0XOjYlfH-K6fVAfdajmGAuA4G14vMgs&_nc_zt=23&_nc_ht=scontent.fdel29-1.fna&_nc_gid=Ge4w_8Bk6G-jziiHj6v6Zg&oh=00_AfO8zpW3lsJnHy-F85O8JcZStTRF8vYvMHS0uYVDlP_utg&oe=685581D0',
        'https://scontent.fdel29-1.fna.fbcdn.net/v/t39.30808-6/487481909_1119179903553582_1881812737059541553_n.jpg?_nc_cat=104&ccb=1-7&_nc_sid=127cfc&_nc_ohc=Gpt895laxHUQ7kNvwE0gIh0&_nc_oc=Adn5vGAB8mWC_EICH2d9v9FXEzdOmq5ylqjTnVV0lmdnsHGtyHLbhy-I_uu6fRIhsgE&_nc_zt=23&_nc_ht=scontent.fdel29-1.fna&_nc_gid=gtojWnRH1mQvHbCNtnzQoA&oh=00_AfPrfzJa2arjZfYSzsOlGzbII8Elc3ZR6Y3CsewMoLvlbg&oe=68558196',
        'https://scontent.fdel29-1.fna.fbcdn.net/v/t39.30808-6/487377942_1119179970220242_4730354117429322465_n.jpg?_nc_cat=105&ccb=1-7&_nc_sid=127cfc&_nc_ohc=HlQZhhO8HW4Q7kNvwGXP_GR&_nc_oc=AdkxoDEMqeX1NF4sIQJ9LUabtRug9u_t2psfFc4NYBu9nBy_drjsHNgrL8HE3zK6N58&_nc_zt=23&_nc_ht=scontent.fdel29-1.fna&_nc_gid=mCPLyjGDZV1CkdvdNemWxg&oh=00_AfNbMWeWO6UxudPhVjmVF70-lWxg4_wRMVeTd7By5zsN7g&oe=68558930',
        'https://scontent.fdel29-1.fna.fbcdn.net/v/t39.30808-6/487830237_1119179930220246_8733243530194802122_n.jpg?_nc_cat=109&ccb=1-7&_nc_sid=127cfc&_nc_ohc=G2qugV1zlsgQ7kNvwHQ4keN&_nc_oc=Adl8tlpqJ98ElFowxJYSSQqCBOQ4uzWjiedaQgZiNC8PKE1ObEbIik9bf0MP-S0rFk0&_nc_zt=23&_nc_ht=scontent.fdel29-1.fna&_nc_gid=TPWOdKDDu7JUQtbCUI3iBw&oh=00_AfOJz5YiMkpDSYHZ3HrR4j0ZFU0XUbXfKRh-QwTysWH3Bw&oe=685594F7'
      ]
    },
    {
      title: 'Kerala Soap - Export Launch 13/07/2024', district: 'Kozhikode', department: 'Production Department', status: 'completed',
      thumbnail: 'https://www.ksie.net/gallery/DSC00271.jpg',
      summary:'Government of Kerala presented “Kerala Soaps”, the new Soaps manufacturing unit as a “new year gift” to the people of Kerala in a fabulous ceremony.Kerala Soaps will begin export of premium sandalwood-based.',
      images: [
        'https://www.ksie.net/gallery/DSC00322.jpg',
        'https://www.ksie.net/gallery/DSC00079.jpg'
      ]
    },
    {
      title: 'Education Drive - Kozhikode-phase-2', district: 'Kozhikode', department: 'Education', status: 'under-construction',
      thumbnail: 'https://images.indianexpress.com/2021/11/gdp-construction-express-archieve-.jpeg',
      summary:'The second phase of the "Pothuvidyabhyasa Samrakshana Yajnam" (Save Public Education Drive) in Kozhikode, Kerala, focuses on preparing an academic master plan to ensure the growth of each student and school. ',
      images: [
        'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTKj0E_Ey4edXLRBB82A9SKYXE1vsK7cfkQd_yq8Wm2Hlhhoxkd4WQRPmD2ZgWr1iZVo6I&usqp=CAU',
        'https://www.winntus.com/uploaded-files/category/images/thumbs/Aluminium-Formwork-Rental-thumbs-350X350.jpg',
        'https://www.winntus.com/uploaded-files/gallery/photos/thumbs/Monolithic-Formwork-System-Project38-thumbs-500X500.jpg'
      ]
    },
    {
      title: 'Education Drive - Tiruvantapuram', district: 'Tiruvantapuram', department: 'Education', status: 'under-construction',
      thumbnail: 'https://th-i.thgim.com/public/news/national/ks976j/article34745096.ece/alternates/FREE_1200/SchoolEducation',
      summary:'Thiruvananthapuram, Kerala, has a well-established education system with numerous institutions across various levels, from primary to higher education and specialized training. The city is known for its high literacy rates and strong commitment to education',
      images: [
        'https://th-i.thgim.com/public/news/national/ks976j/article34745096.ece/alternates/FREE_1200/SchoolEducation',
        'https://upload.wikimedia.org/wikipedia/commons/thumb/5/5f/University_of_Kerala.jpg/1200px-University_of_Kerala.jpgU'
      ]
    },
    {
      title: 'Health Wellness - Alappuzha', district: 'Alappuzha', department: 'Health', status: 'running',
      thumbnail: 'https://th-i.thgim.com/public/incoming/dbx5ng/article68569320.ece/alternates/LANDSCAPE_1200/11073_26_8_2024_16_28_28_2_27TVAL2_HEALTHCENTRE.JPG',
       summary:'As part of efforts to provide better health care and disease prevention, an urban public health centre was opened in Powerhouse ward of Alappuzha municipality on Monday. It was inaugurated by P.P. Chitharanjan, MLA.',
      images: [
        'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSqiGNv2UCdcYOmmpgUTde1WBdpKRtYT5BRmQ&s',
        'https://media.assettype.com/tnm%2Fimport%2Fsites%2Fdefault%2Ffiles%2Fpunalur_hospital_kerala.jpg?w=480&auto=format%2Ccompress&fit=max',
        'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRGMziL-SveGHgvAzA8Y7gwrHVxS8guGYjs3k8OO0ltRHtd15XYo2gvu_4Eq5vFy-OF-ug&usqp=CAU',
        'https://images.thesouthfirst.com/wp-content/uploads/2023/01/Kerala-Health-Minister-Veena-George_V_jpg--442x260-4g.webp?sw=412&dsz=442x260&iw=382&p=false&r=2.625'
      ]
    },
      {
      title: 'Free Cancer Screening Camp', district: 'Tiruvantapuram', department: 'Health', status: 'under-construction',
      thumbnail: 'https://www.bcmch.org/asset/uploads/upcomingevents/302116049680a3875b4d25.jpeg',
      summary:'In a collaborative effort to combat cancer, "Kerala Can," a flagship initiative jointly organized by Believers Hospital and Manorama News, has joined forces with Alappuzha to host a free cancer screening camp.',
      images: [
        'https://www.bcmch.org/asset/uploads/upcomingevents/302116049680a3875b4d25.jpeg',
        'https://www.bcmch.org/asset/uploads/upcomingevents/264193894680a29c430dc5.jpeg',
        'https://www.bcmch.org/asset/uploads/upcomingevents/1879826185680a2d5663f66.jpeg'
      ]
    }
    
  ];
  const cmVisits = [
    {
      title: 'MD Visit - Kochi Metro',
      district: 'Ernakulam',
      thumbnail: 'https://keralakaumudi.com/web-news/en/2024/01/NMAN0469003/image/thumb/biju-prabhakar.1.2539832.webp',
       summary:'Kochi: Chief Minister Pinarayi Vijayan took a ride on the Metro from Palarivattom to Aluva on Saturday. His visit was aimed at carrying out a final review of the preparation at the Metro ahead of its inauguration by Prime Minister Narendra Modi.',
      images: [
        'https://img.etimg.com/photo/msid-59189152,quality-100/kochi-metro.jpg',
        'https://english.mathrubhumi.com/image/contentid/policy:1.8096417:1698477880/CM%20Pinarayi%20Kochi%20Metro.jpg?$p=ed5292c&w=600&f=16:9&q=0.8'
      ]
    },
    {
      title: 'MD Health Camp - Alappuzha',
      district: 'Alappuzha',
      thumbnail: 'https://keralakaumudi.com/web-news/en/2024/09/NMAN0527722/image/thumb/medisep.1.2897021.webp',
       summary:'Government of Kerala presented “Kerala Soaps”, the new Soaps manufacturing unit as a “new year gift” to the people of Kerala in a fabulous ceremony.',
      images: [
        'https://media.assettype.com/tnm%2Fimport%2Fsites%2Fdefault%2Ffiles%2Fpunalur_hospital_kerala.jpg',
        'https://images.thesouthfirst.com/wp-content/uploads/2023/01/Kerala-Health-Minister-Veena-George_V_jpg--442x260-4g.webp'
      ]
    },
      {
      title: 'MD Health Camp - Alappuzha',
      district: 'Alappuzha',
      thumbnail: 'https://th-i.thgim.com/public/incoming/ucq387/article68787099.ece/alternates/FREE_1200/11073_23_10_2024_17_15_52_1_24TVAL1_GENERALHOSPITAL.JPG',
       summary:'Government of Kerala presented “Kerala Soaps”, the new Soaps manufacturing unit as a “new year gift” to the people of Kerala in a fabulous ceremony.',
      images: [
        'https://images.hindustantimes.com/rf/image_size_630x354/HT/p2/2018/08/26/Pictures/kerala-floods_b67c9626-a940-11e8-bc28-d27389838637.jpg',
        'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQFomxjzlT0yRTcwboc8kChQoewoBtMAJGsNg&s'
      ]
    }
  ];

 function renderProjects() {
  const district = document.getElementById('districtFilter').value;
  const department = document.getElementById('departmentFilter').value;
  const status = document.getElementById('statusFilter').value;
  const grid = document.getElementById('projectGrid');
  grid.innerHTML = '';

  const filtered = projects.filter(p =>
    (district === 'All' || p.district === district) &&
    (department === 'All' || p.department === department) &&
    (status === 'All' || p.status === status)
  );

  if (filtered.length === 0) {
    grid.innerHTML = `<p style="color:red;">No projects found.</p>`;
    return;
  }

  filtered.forEach(project => {
    grid.appendChild(createCard(project));
  });
}

function renderCMVisits() {
  const district = document.getElementById('cmDistrictFilter').value;
  const grid = document.getElementById('cmVisitGrid');
  grid.innerHTML = '';

  const filtered = cmVisits.filter(p =>
    district === 'All' || p.district === district
  );

  if (filtered.length === 0) {
    grid.innerHTML = `<p style="color:red;">No CM visits found.</p>`;
    return;
  }

  filtered.forEach(visit => {
    grid.appendChild(createCard(visit));
  });
}

// ✅ UPDATED HERE: Button text changed to \"View More Images\"
function createCard(project) {
  const card = document.createElement('div');
  card.className = 'card';

  card.innerHTML = `
    <img src="${project.thumbnail}" alt="${project.title}">
    <div class="card-content">
      <h3>${project.title}</h3>
      <p class="district-name">${project.district}</p>
      <p class="summary-text">${project.summary || 'No summary available.'}</p>
      
      <div class="card-buttons">
        <button class="view-btn">📸 View More Images</button>
        <button class="share-btn">📤 Share</button>
      </div>
    </div>
  `;

  // View More Images
  card.querySelector('.view-btn').addEventListener('click', () => {
    openModal(project.images, project.title);
  });

  // Share Button logic
  card.querySelector('.share-btn').addEventListener('click', (e) => {
    e.stopPropagation();

    const dropdown = document.getElementById("globalShareDropdown");

    // Update share links
    document.getElementById("facebookLink").href =
      `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(project.thumbnail)}`;
    document.getElementById("whatsappLink").href =
      `https://api.whatsapp.com/send?text=${encodeURIComponent(project.title + ' - ' + project.thumbnail)}`;
    document.getElementById("twitterLink").href =
      `https://twitter.com/intent/tweet?text=${encodeURIComponent(project.title)}&url=${encodeURIComponent(project.thumbnail)}`;
    document.getElementById("linkedinLink").href =
      `https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(project.thumbnail)}`;

    // Position dropdown near the button
    const rect = e.target.getBoundingClientRect();
    dropdown.style.top = `${rect.bottom + window.scrollY}px`;
    dropdown.style.left = `${rect.left + window.scrollX}px`;
    dropdown.classList.remove("hidden");
  });

  return card;
}

// ✅ Close dropdown when clicking anywhere outside
document.addEventListener("click", function (e) {
  const dropdown = document.getElementById("globalShareDropdown");
  if (!e.target.closest('.share-btn') && !e.target.closest('#globalShareDropdown')) {
    dropdown.classList.add("hidden");
  }
});


// end of the code 

function openModal(images, title) {
  const modal = document.getElementById('imageModal');
  document.getElementById('modalTitle').textContent = title;
  const container = document.getElementById('modalImages');
  container.innerHTML = '';

  images.forEach(img => {
    const image = document.createElement('img');
    image.src = img;
    image.onclick = (e) => {
      e.stopPropagation();
      openFullscreenWithZoom(img);
    };
    container.appendChild(image);
  });

  modal.style.display = 'flex';
}

function closeModal() {
  document.getElementById('imageModal').style.display = 'none';
}

function openFullscreenWithZoom(imgSrc) {
  const fullscreenDiv = document.createElement('div');
  fullscreenDiv.style.position = 'fixed';
  fullscreenDiv.style.top = '0';
  fullscreenDiv.style.left = '0';
  fullscreenDiv.style.width = '100vw';
  fullscreenDiv.style.height = '100vh';
  fullscreenDiv.style.backgroundColor = 'rgba(0, 0, 0, 0.95)';
  fullscreenDiv.style.display = 'flex';
  fullscreenDiv.style.justifyContent = 'center';
  fullscreenDiv.style.alignItems = 'center';
  fullscreenDiv.style.zIndex = '10000';

  const zoomImg = document.createElement('img');
  zoomImg.src = imgSrc;
  zoomImg.style.maxWidth = '90%';
  zoomImg.style.maxHeight = '90%';
  zoomImg.style.cursor = 'zoom-out';
  zoomImg.style.transition = 'transform 0.3s ease';
  zoomImg.style.transform = 'scale(1.2)';

  fullscreenDiv.onclick = () => document.body.removeChild(fullscreenDiv);
  fullscreenDiv.appendChild(zoomImg);
  document.body.appendChild(fullscreenDiv);
}

window.addEventListener('click', function (event) {
  const modal = document.getElementById('imageModal');
  if (modal.style.display === 'flex' && event.target === modal) {
    closeModal();
  }
});

document.getElementById('districtFilter').addEventListener('change', renderProjects);
document.getElementById('departmentFilter').addEventListener('change', renderProjects);
document.getElementById('statusFilter').addEventListener('change', renderProjects);
document.getElementById('cmDistrictFilter').addEventListener('change', renderCMVisits);

window.onload = () => {
  renderProjects();
  renderCMVisits();
};
// code of logout
function openLogoutModal() {
  document.getElementById('logoutModal').style.display = 'block';
}

function closeLogoutModal() {
  document.getElementById('logoutModal').style.display = 'none';
}

function confirmLogout() {
  // Optional: clear user session
  // localStorage.clear();

  // Redirect to logout or login page
  window.location.href = "Govt_login.html";
}


function updateDateTime() {
  const now = new Date();
  document.getElementById('currentDate').textContent = now.toLocaleDateString();
  document.getElementById('currentTime').textContent = now.toLocaleTimeString();
  document.getElementById('lastUpdated').textContent = now.toLocaleString();
}
setInterval(updateDateTime, 1000);
updateDateTime();

const chatbotDistricts = ['Thiruvananthapuram','Kollam','Pathanamthitta','Alappuzha','Kottayam','Idukki','Ernakulam','Thrissur','Palakkad','Malappuram','Kozhikode','Wayanad','Kannur','Kasaragod'];
// Close when clicking outside
window.addEventListener("click", function (e) {
  const modal = document.getElementById("chatbotModal");
  if (e.target === modal) {
    modal.style.display = "none";
  }
});

// Populate dropdown
window.addEventListener('DOMContentLoaded', () => {
  const dmSelect = document.getElementById("dmSelect");
  if (!dmSelect) return;
  const districts = ['Thiruvananthapuram','Kollam','Pathanamthitta','Alappuzha','Kottayam','Idukki','Ernakulam','Thrissur','Palakkad','Malappuram','Kozhikode','Wayanad','Kannur','Kasaragod'];
  districts.forEach(d => {
    const opt = document.createElement("option");
    opt.value = d;
    opt.textContent = d;
    dmSelect.appendChild(opt);
  });
});

// Dummy chat logic
function sendMessage() {
  const dm = document.getElementById("dmSelect").value;
  const msg = document.getElementById("userMessage").value.trim();
  const chatBox = document.getElementById("chatBox");
  if (!msg) return;

  const userMsg = `<div><strong>You:</strong> ${msg}</div>`;
  const replyMsg = `<div><strong>${dm} DM:</strong> Thanks for reaching out. We'll respond soon.</div>`;
  
  chatBox.innerHTML += userMsg + replyMsg;
  document.getElementById("userMessage").value = "";
  chatBox.scrollTop = chatBox.scrollHeight;
}
function toggleChatbot() {
  const modal = document.getElementById("chatbotModal");
  if (!modal) return;
  modal.style.display = modal.style.display === "flex" ? "none" : "flex";
}
function openAIChatModal() {
  document.getElementById("aiModal").style.display = "flex";
  document.getElementById("aiChatBox").innerHTML = "";
}

function closeAIChatModal() {
  document.getElementById("aiModal").style.display = "none";
}

function sendAIMessage() {
  const input = document.getElementById("aiUserMessage");
  const chatBox = document.getElementById("aiChatBox");
  const msg = input.value.trim();
  if (!msg) return;

  // Add user bubble
  const userBubble = `<div class="bubble user">You: ${msg}</div>`;
  chatBox.innerHTML += userBubble;

  // Auto scroll
  chatBox.scrollTop = chatBox.scrollHeight;

  // AI Reply
  const lowerMsg = msg.toLowerCase();
  let reply = "I'm here to assist you with Kerala district data.";

  if (lowerMsg.includes("performance")) reply = "You can view performance in the dashboard chart.";
  else if (lowerMsg.includes("budget")) reply = "Budget is shown in each district card.";
  else if (lowerMsg.includes("status")) reply = "Status updates are available under Reports.";
  else if (lowerMsg.includes("hello") || lowerMsg.includes("hi")) reply = "Hello! How can I help you today?";
  else if (lowerMsg.includes("report")) reply = "Reports can be accessed from the sidebar.";
  else reply = "Let me look into that and get back to you.";

  // Add AI reply with delay
  setTimeout(() => {
    const aiBubble = `<div class="bubble ai">AI: ${reply}</div>`;
    chatBox.innerHTML += aiBubble;
    chatBox.scrollTop = chatBox.scrollHeight;
  }, 600);

  input.value = "";
}


